"use strict";(self.webpackChunkstudy_in_moldova=self.webpackChunkstudy_in_moldova||[]).push([[779],{779:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var s=t(43),i=t(213),n=t(375),r=t(579);const o=()=>{var e,a,t;const[o,l]=(0,s.useState)([]),[c,d]=(0,s.useState)(!0),[p,u]=(0,s.useState)(null),[m,h]=(0,s.useState)(""),[v,g]=(0,s.useState)(null),[j,f]=(0,s.useState)(!1),[x,w]=(0,s.useState)(!1),[y,N]=(0,s.useState)([]),[_,b]=(0,s.useState)("user"),[A,S]=(0,s.useState)([]),[E,D]=(0,s.useState)({program_id:"",motivation_letter:"",selectedDocuments:[],is_paid:!1,errors:{program:"",documents:"",motivation_letter:"",payment:""}}),[P,C]=(0,s.useState)([]);(0,s.useEffect)((()=>{R(),k(),I(),$(),U()}),[]);const I=async()=>{try{"admin"===(await i.A.get(`${n.JR}/api/user/role`,{headers:(0,n.z5)()})).data.role&&b("admin")}catch(p){console.error("Error checking role:",p)}},k=async()=>{try{const e=await i.A.get(`${n.JR}/api/programs`,{headers:(0,n.z5)()});e.data.success&&N(e.data.data)}catch(p){console.error("Error loading programs:",p)}},R=async()=>{try{d(!0);const e="admin"===_?`${n.JR}/api/applications`:`${n.JR}/api/applications/user`,a=await i.A.get(e,{headers:(0,n.z5)()});if(!a.data||!a.data.success)throw new Error("No valid data received from server");const t=a.data.data;if(!Array.isArray(t))throw console.error("Invalid data received:",t),new Error("Invalid data format: data is not an array");const s=t.map((e=>({...e,documents:e.documents||[],program:e.program||{},created_at:e.created_at||(new Date).toISOString(),status:e.status||"draft",is_paid:"paid"===e.payment_status||e.is_paid||!1,payment_status:e.payment_status||"unpaid",payment_date:e.payment_date||null,payment_amount:e.payment_amount||null,payment_currency:e.payment_currency||null})));console.log("Processed applications:",s),l(s)}catch(p){console.error("Error loading applications:",p),u("An error occurred while loading applications. Please try again."),l([])}finally{d(!1)}},$=async()=>{try{const e=await i.A.get(`${n.JR}/api/documents/user-documents`,{headers:(0,n.z5)()});e.data.success&&S(e.data.data)}catch(p){console.error("Error loading documents:",p)}},U=async()=>{try{const e=await i.A.get(`${n.JR}/api/saved-programs`,{headers:(0,n.z5)()});e.data.success&&C(e.data.data)}catch(p){console.error("Error loading saved programs:",p)}},J=async e=>{console.log("Starting submission for application:",e);const a=o.find((a=>a.id===e));if(!a)return console.error("Application not found:",e),void u("Application not found");if(console.log("Found application:",a),!a.is_paid)return console.error("Application not paid:",a),void u("You cannot submit the application without paying the application fee. Please make the payment first.");var t;if(!a.program_id||!a.motivation_letter||!a.documents||0===a.documents.length)return console.error("Missing required fields:",{program_id:a.program_id,has_motivation_letter:!!a.motivation_letter,documents_count:null===(t=a.documents)||void 0===t?void 0:t.length}),void u("Please make sure all required fields are filled and documents are attached before submitting.");try{d(!0),u(null),console.log("Sending submission request to:",`${n.JR}/api/applications/${e}/status`);const a=await i.A.put(`${n.JR}/api/applications/${e}/status`,{status:"submitted",notes:"Application submitted by user"},{headers:{...(0,n.z5)(),"Content-Type":"application/json"}});if(console.log("Submission response:",a.data),!a.data.success)throw new Error(a.data.message||"Error submitting application");h("Application submitted successfully!"),f(!1),w(!1),g(null),await R()}catch(p){var s,r;console.error("Error submitting application:",p),u((null===(s=p.response)||void 0===s||null===(r=s.data)||void 0===r?void 0:r.message)||"An error occurred while submitting the application")}finally{d(!1)}},z=async e=>{try{console.log("Starting application edit:",e),d(!0),u(null);const t=await i.A.get(`${n.JR}/api/applications/${e.id}`,{headers:(0,n.z5)()});if(console.log("Server response:",t.data),!t.data.success)throw new Error("Could not load application data");{var a;const e=t.data.data;console.log("Loaded application data:",e),g(e);const s={program_id:e.program_id,motivation_letter:e.motivation_letter||"",selectedDocuments:(null===(a=e.documents)||void 0===a?void 0:a.map((e=>e.id)))||[],is_paid:e.is_paid||!1,errors:{program:"",documents:"",motivation_letter:"",payment:""}};console.log("Form data:",s),D(s),w(!0),f(!1),console.log("State after setting:",{selectedApplication:e,newApplication:s,showCreateForm:!0})}}catch(p){console.error("Error loading application data:",p),u("An error occurred while loading application data. Please try again.")}finally{d(!1)}};(0,s.useEffect)((()=>{if(x&&v&&(console.log("Form opened with data:",{selectedApplication:v,newApplication:E}),v.documents&&v.documents.length>0)){const e=v.documents.map((e=>e.id));console.log("Existing documents for selection:",e),D((a=>({...a,selectedDocuments:e})))}}),[x,v]);const q=e=>{console.log("Toggle document:",e),D((a=>{const t=a.selectedDocuments.includes(e)?a.selectedDocuments.filter((a=>a!==e)):[...a.selectedDocuments,e];return console.log("Selected documents after toggle:",t),{...a,selectedDocuments:t,errors:{...a.errors,documents:0===t.length?"Please select at least one document":""}}}))},L=async function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{if(!e||isNaN(parseInt(e)))throw new Error("Invalid application ID");d(!0),u(null),console.log("Starting status update:",{applicationId:e,newStatus:a,adminNotes:t});const r=await i.A.patch(`${n.JR}/api/applications/${e}/status`,{status:a,notes:t},{headers:{...(0,n.z5)(),"Content-Type":"application/json"}});var s;if(console.log("Server response:",r.data),!r.data||!r.data.success)throw new Error((null===(s=r.data)||void 0===s?void 0:s.message)||"Error updating status");h("Application status updated successfully!"),f(!1),g(null),await R()}catch(p){if(console.error("Error updating status:",p),p.response)if(404===p.response.status)u("Application not found. Please refresh the page.");else if(403===p.response.status)u("You do not have permission to update this application.");else{var r;u((null===(r=p.response.data)||void 0===r?void 0:r.message)||"An error occurred while updating the application status.")}else p.request?u("Could not communicate with the server. Please check your internet connection."):u(p.message||"An unexpected error occurred.")}finally{d(!1)}},T=e=>{if(!e)return"N/A";try{const a=new Date(e);return isNaN(a.getTime())?"Invalid date":a.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch(p){return console.error("Error formatting date:",p),"Invalid date"}},Y=e=>{if(!e)return"Unknown";switch(e){case"draft":return"Draft";case"submitted":return"Submitted";case"under_review":return"Under Review";case"approved":return"Approved";case"rejected":return"Rejected";case"withdrawn":return"Withdrawn";default:return e.charAt(0).toUpperCase()+e.slice(1)}},M=e=>{if(!e)return"status-unknown";switch(e){case"draft":return"status-draft";case"submitted":return"status-submitted";case"under_review":return"status-under-review";case"approved":return"status-approved";case"rejected":return"status-rejected";case"withdrawn":return"status-withdrawn";default:return"status-unknown"}},F=e=>"admin"===_||"draft"===e.status&&!e.submitted_at,W=e=>"admin"!==_&&"draft"===e.status;return(0,s.useEffect)((()=>{const e=new URLSearchParams(window.location.search).get("payment");if("success"===e){const e=localStorage.getItem("paymentApplicationId");if(e){const a=async()=>{try{if(!e||isNaN(parseInt(e)))throw new Error("Invalid application ID");const a=await i.A.get(`${n.JR}/api/applications/${e}`,{headers:(0,n.z5)()});if(!a.data||!a.data.success)throw new Error("Could not verify application status");a.data.data.is_paid?h("Payment has already been processed successfully!"):h("Payment processed successfully!"),localStorage.removeItem("paymentApplicationId"),localStorage.removeItem("currentPaymentSession"),window.history.replaceState({},document.title,window.location.pathname),await R(),f(!1),g(null)}catch(p){console.error("Error processing payment:",p),u("An error occurred while verifying payment status. Please contact support.")}};a()}}else if("canceled"===e){const e=localStorage.getItem("paymentApplicationId");e&&(console.log("Payment canceled for application:",e),localStorage.removeItem("paymentApplicationId"),localStorage.removeItem("currentPaymentSession"),window.history.replaceState({},document.title,window.location.pathname),u("Payment was canceled. You can try again."))}}),[]),(0,r.jsxs)("div",{className:"application-tab",children:[(0,r.jsxs)("div",{className:"application-section",children:[(0,r.jsx)("h2",{children:"admin"===_?"All Applications":"My Applications"}),"user"===_&&(0,r.jsxs)("button",{className:"btn1",onClick:()=>w(!0),style:{margin:"20px 0"},children:[(0,r.jsx)("i",{className:"fas fa-plus"})," Create New Application"]})]}),m&&(0,r.jsx)("div",{className:"alert-success",children:m}),p&&(0,r.jsx)("div",{className:"alert-error",children:p}),(0,r.jsxs)("div",{className:"application-stats",children:[(0,r.jsxs)("div",{className:"application-stat",children:["Drafts",(0,r.jsx)("span",{className:"stat-value status-draft",children:o.filter((e=>"draft"===e.status)).length})]}),(0,r.jsxs)("div",{className:"application-stat",children:["Submitted",(0,r.jsx)("span",{className:"stat-value status-submitted",children:o.filter((e=>"submitted"===e.status)).length})]}),(0,r.jsxs)("div",{className:"application-stat",children:["Under Review",(0,r.jsx)("span",{className:"stat-value status-under-review",children:o.filter((e=>"under_review"===e.status)).length})]}),(0,r.jsxs)("div",{className:"application-stat",children:["Approved",(0,r.jsx)("span",{className:"stat-value status-approved",children:o.filter((e=>"approved"===e.status)).length})]}),(0,r.jsxs)("div",{className:"application-stat",children:["Rejected",(0,r.jsx)("span",{className:"stat-value status-rejected",children:o.filter((e=>"rejected"===e.status)).length})]}),(0,r.jsxs)("div",{className:"application-stat",children:["Withdrawn",(0,r.jsx)("span",{className:"stat-value status-withdrawn",children:o.filter((e=>"withdrawn"===e.status)).length})]})]}),c?(0,r.jsxs)("div",{className:"loading-container",children:[(0,r.jsx)("div",{className:"loading-spinner"}),(0,r.jsx)("p",{children:"Loading applications..."})]}):0===o.length?(0,r.jsx)("div",{className:"no-applications",children:(0,r.jsx)("p",{children:"No applications found."})}):(0,r.jsx)("div",{className:"applications-table-container",children:(0,r.jsxs)("table",{className:"profile-table",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:["admin"===_&&(0,r.jsx)("th",{children:"User"}),(0,r.jsx)("th",{children:"Program"}),(0,r.jsx)("th",{children:"University"}),(0,r.jsx)("th",{children:"Application Date"}),(0,r.jsx)("th",{children:"Status"}),(0,r.jsx)("th",{children:"Payment"}),(0,r.jsx)("th",{children:"Actions"})]})}),(0,r.jsx)("tbody",{children:o.map((e=>{var a,t,s;return(0,r.jsxs)("tr",{children:["admin"===_&&(0,r.jsx)("td",{children:e.user_name||`User ID: ${e.user_id}`}),(0,r.jsx)("td",{children:(null===(a=e.program)||void 0===a?void 0:a.name)||"N/A"}),(0,r.jsx)("td",{children:(null===(t=e.program)||void 0===t||null===(s=t.university)||void 0===s?void 0:s.name)||"N/A"}),(0,r.jsx)("td",{children:T(e.created_at)}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{className:`status-badge ${M(e.status)}`,children:Y(e.status)})}),(0,r.jsx)("td",{children:(0,r.jsx)("span",{className:"payment-status "+(e.is_paid?"paid":"unpaid"),children:e.is_paid?"Paid":"Unpaid"})}),(0,r.jsxs)("td",{children:[(0,r.jsxs)("button",{className:"btn2",onClick:()=>(e=>{const a={...e,documents:e.documents||[],program:e.program||{},created_at:e.created_at||(new Date).toISOString(),status:e.status||"draft",is_paid:e.is_paid||!1};g(a),f(!0)})(e),style:{marginRight:"10px"},children:[(0,r.jsx)("i",{className:"fas fa-eye"})," View"]}),W(e)&&(0,r.jsxs)("button",{className:"btn1",onClick:()=>z(e),children:[(0,r.jsx)("i",{className:"fas fa-edit"})," Edit"]}),W(e)&&!e.is_paid&&(0,r.jsxs)("button",{className:"btn1",style:{marginLeft:"10px"},onClick:()=>(async e=>{try{var a;if(d(!0),u(null),!e)throw new Error("Selecteaz\u0103 o aplica\u021bie \xeenainte de a efectua plata");if(e.is_paid)throw new Error("Aceast\u0103 aplica\u021bie a fost deja pl\u0103tit\u0103");console.log("\xcencep procesul de plat\u0103 pentru aplica\u021bia:",e.id);const t=y.find((a=>a.id===e.program_id));if(!t)throw new Error("Programul selectat nu a fost g\u0103sit");const s={application_id:e.id,program_id:e.program_id,amount:t.tuition_fees,motivation_letter:e.motivation_letter||"",document_ids:(null===(a=e.documents)||void 0===a?void 0:a.map((e=>e.id)))||[]};console.log("Date plat\u0103:",s);const r=await i.A.post(`${n.JR}/api/payments/create-checkout-session`,s,{headers:{...(0,n.z5)(),"Content-Type":"application/json"}});if(console.log("R\u0103spuns server pentru sesiunea de plat\u0103:",r.data),!r.data)throw new Error("Nu s-a primit r\u0103spuns de la server");if(!r.data.success)throw new Error(r.data.message||"Eroare la crearea sesiunii de plat\u0103");if(!r.data.url)throw new Error("Lipse\u0219te URL-ul de plat\u0103 din r\u0103spunsul serverului");localStorage.setItem("currentPaymentSession",r.data.session_id),localStorage.setItem("paymentApplicationId",e.id),console.log("Redirec\u021bionare c\u0103tre pagina de plat\u0103:",r.data.url),window.location.href=r.data.url}catch(p){var t,s;console.error("Eroare la procesarea pl\u0103\u021bii:",p),u((null===(t=p.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||p.message||"A ap\u0103rut o eroare la procesarea pl\u0103\u021bii")}finally{d(!1)}})(e),children:[(0,r.jsx)("i",{className:"fas fa-credit-card"})," Pay 100 MDL"]})]})]},e.id)}))})]})}),x&&(0,r.jsx)("div",{className:"modal",children:(0,r.jsxs)("div",{className:"modal-content",children:[(0,r.jsx)("h2",{children:v?"Edit Application":"Create New Application"}),(0,r.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={program:"",documents:"",motivation_letter:"",payment:""};let a=!0;return E.program_id&&!E.program_id&&(e.program="Selected program is not valid",a=!1),E.motivation_letter&&!E.motivation_letter.trim()&&(e.motivation_letter="Motivation letter cannot be empty",a=!1),D((a=>({...a,errors:e}))),a})())try{var a;d(!0),u(null);const e={program_id:E.program_id?parseInt(E.program_id):null===v||void 0===v?void 0:v.program_id,motivation_letter:E.motivation_letter||(null===v||void 0===v?void 0:v.motivation_letter)||"",status:"draft",document_ids:E.selectedDocuments.length>0?E.selectedDocuments.map((e=>parseInt(e))):(null===v||void 0===v||null===(a=v.documents)||void 0===a?void 0:a.map((e=>parseInt(e.id))))||[],is_paid:(null===v||void 0===v?void 0:v.is_paid)||!1};let t;if(console.log("Data sent to server:",e),t=v?await i.A.put(`${n.JR}/api/applications/${v.id}/update`,e,{headers:{...(0,n.z5)(),"Content-Type":"application/json"}}):await i.A.post(`${n.JR}/api/applications`,e,{headers:{...(0,n.z5)(),"Content-Type":"application/json"}}),!t.data.success)throw new Error(t.data.message||(v?"Error updating application":"Error creating application"));h(v?"Application updated successfully!":"Application created successfully!"),w(!1),D({program_id:"",motivation_letter:"",selectedDocuments:[],is_paid:!1,errors:{program:"",documents:"",motivation_letter:"",payment:""}}),g(null),await R()}catch(p){var t,s;console.error("Error:",p),u((null===(t=p.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.message)||(v?"An error occurred while updating the application":"An error occurred while creating the application"))}finally{d(!1)}},className:"application-form",children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsxs)("label",{children:["Program: ",(0,r.jsx)("span",{className:"required",children:"*"})]}),(0,r.jsxs)("select",{value:E.program_id||"",onChange:e=>{console.log("Selected program:",e.target.value),D({...E,program_id:e.target.value,errors:{...E.errors,program:""}})},className:"form-select "+(E.errors.program?"error":""),children:[(0,r.jsx)("option",{value:"",children:"Select a program"}),P.map((e=>{var a;return(0,r.jsxs)("option",{value:e.id,children:[e.name," - ",null===(a=e.university)||void 0===a?void 0:a.name]},e.id)}))]}),E.errors.program&&(0,r.jsx)("span",{className:"error-message",children:E.errors.program})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsxs)("label",{children:["Motivation Letter: ",(0,r.jsx)("span",{className:"required",children:"*"})]}),(0,r.jsx)("textarea",{value:E.motivation_letter||"",onChange:e=>{console.log("Updated motivation letter:",e.target.value),D({...E,motivation_letter:e.target.value,errors:{...E.errors,motivation_letter:""}})},className:"form-textarea "+(E.errors.motivation_letter?"error":""),rows:"6",placeholder:"Write your motivation letter..."}),E.errors.motivation_letter&&(0,r.jsx)("span",{className:"error-message",children:E.errors.motivation_letter})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsxs)("label",{children:["Required Documents: ",(0,r.jsx)("span",{className:"required",children:"*"})]}),(0,r.jsx)("p",{className:"documents-help-text",children:"Please select the necessary documents for the selected program"}),(0,r.jsxs)("div",{className:"documents-selection",children:[A&&0!==A.length?(0,r.jsx)("div",{className:"documents-list",children:A.map((e=>{const a=E.selectedDocuments.includes(e.id);return console.log(`Document ${e.id} is selected:`,a),(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("label",{className:"document-checkbox",children:[(0,r.jsx)("input",{type:"checkbox",checked:a,onChange:()=>q(e.id)}),(0,r.jsx)("span",{children:" "}),(0,r.jsx)("span",{className:"document-name",children:e.name||e.document_type})]})})}))}):(0,r.jsx)("p",{className:"no-documents",children:"You don't have any documents uploaded yet. Please upload documents in the profile section."}),E.errors.documents&&(0,r.jsx)("span",{className:"error-message",children:E.errors.documents})]})]}),(0,r.jsx)("div",{className:"form-info",children:(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{className:"required",children:"*"})," Required fields"]})}),(0,r.jsxs)("div",{className:"button-group",children:[(0,r.jsx)("button",{type:"submit",className:"btn1",children:v?"Update Application":"Save Application"}),v&&"draft"===v.status&&(0,r.jsxs)("button",{type:"button",className:"btn1",onClick:()=>{v.is_paid?J(v.id):u("You need to pay the application fee to submit the application")},disabled:!v.program_id||!v.motivation_letter||!v.documents||0===v.documents.length||!v.is_paid||c,children:[(0,r.jsx)("i",{className:"fas fa-paper-plane"})," Submit Application",!v.is_paid&&(0,r.jsx)("span",{className:"payment-required",children:"(Payment required)"})]})]})]}),(0,r.jsx)("button",{className:"close-button",onClick:()=>{w(!1),D({program_id:"",motivation_letter:"",selectedDocuments:[],is_paid:!1,errors:{program:"",documents:"",motivation_letter:"",payment:""}}),g(null)},children:(0,r.jsx)("i",{className:"fas fa-times"})})]})}),j&&v&&(0,r.jsx)("div",{className:"modal",children:(0,r.jsxs)("div",{className:"modal-content",children:[(0,r.jsx)("h2",{children:"Application Details"}),(0,r.jsxs)("div",{className:"application-details",children:["admin"===_&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"User:"})," ",v.user_name||`ID: ${v.user_id}`]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Program:"})," ",(null===(e=v.program)||void 0===e?void 0:e.name)||"N/A"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"University:"})," ",(null===(a=v.program)||void 0===a||null===(t=a.university)||void 0===t?void 0:t.name)||"N/A"]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Application Date:"})," ",T(v.created_at)]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Status:"})," ",Y(v.status)]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Payment Status:"}),(0,r.jsx)("span",{className:"payment-status "+(v.is_paid?"paid":"unpaid"),children:v.is_paid?"Paid":"Unpaid"})]}),(0,r.jsxs)("div",{className:"motivation-letter-section",children:[(0,r.jsx)("h3",{children:"Motivation Letter"}),(0,r.jsx)("div",{className:"motivation-letter-content",children:(0,r.jsx)("p",{children:v.motivation_letter||"No motivation letter provided"})})]}),(0,r.jsxs)("div",{className:"documents-section",children:[(0,r.jsx)("h3",{children:"Attached Documents"}),(0,r.jsx)("div",{className:"documents-list",children:v.documents&&v.documents.length>0?v.documents.map(((e,a)=>(0,r.jsxs)("div",{className:"document-item",children:[(0,r.jsxs)("div",{className:"document-info",children:[(0,r.jsxs)("span",{className:"document-type",children:[(0,r.jsx)("i",{className:"fas fa-file-alt"})," ",e.document_type]}),(0,r.jsxs)("span",{className:"document-status",children:[(0,r.jsx)("i",{className:"fas fa-circle "+("approved"===e.status?"status-approved":"rejected"===e.status?"status-rejected":"status-pending")}),"approved"===e.status?"Approved":"rejected"===e.status?"Rejected":"Pending"]})]}),(0,r.jsxs)("div",{className:"document-actions",children:[(0,r.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"btn2",children:[(0,r.jsx)("i",{className:"fas fa-eye"})," View"]}),(0,r.jsx)("span",{className:"document-name",children:e.originalName||e.filename})]})]},a))):(0,r.jsx)("p",{className:"no-documents",children:"No documents attached"})})]}),v.notes&&(0,r.jsxs)("div",{className:"admin-notes",children:[(0,r.jsx)("h3",{children:"Admin Notes"}),(0,r.jsx)("div",{className:"notes-content",children:(0,r.jsx)("p",{children:v.notes})})]}),(0,r.jsxs)("div",{className:"action-buttons",children:[F(v)&&(0,r.jsxs)("button",{className:"btn2",onClick:()=>(async e=>{const a=o.find((a=>a.id===e));if(F(a)){if(window.confirm("Are you sure you want to delete this application?"))try{d(!0),u(null);const a=await i.A.delete(`${n.JR}/api/applications/${e}`,{headers:(0,n.z5)()});if(!a.data.success)throw new Error(a.data.message||"Error deleting application");h("Application deleted successfully!"),f(!1),g(null),await R()}catch(p){var t,s;if(console.error("Error deleting application:",p),404===(null===(t=p.response)||void 0===t?void 0:t.status))u("Application not found. It may have been already deleted.");else if(500===(null===(s=p.response)||void 0===s?void 0:s.status))u("This application cannot be deleted because it has associated records (documents, payments, etc.). Please withdraw the application instead.");else{var r,l;u((null===(r=p.response)||void 0===r||null===(l=r.data)||void 0===l?void 0:l.message)||"An error occurred while deleting the application")}}finally{d(!1)}}else u("You cannot delete this application")})(v.id),children:[(0,r.jsx)("i",{className:"fas fa-trash"})," Delete Application"]}),W(v)&&(0,r.jsxs)("button",{className:"btn1",onClick:()=>z(v),children:[(0,r.jsx)("i",{className:"fas fa-edit"})," Edit Application"]}),"draft"===v.status&&(0,r.jsxs)("button",{className:"btn1",onClick:()=>{v.is_paid?J(v.id):u("You need to pay the application fee to submit the application")},disabled:!v.program_id||!v.motivation_letter||!v.documents||0===v.documents.length||!v.is_paid||c,children:[(0,r.jsx)("i",{className:"fas fa-paper-plane"})," Submit Application",!v.is_paid&&(0,r.jsx)("span",{className:"payment-required",children:"(Payment required)"})]}),(O=v,"admin"!==_&&["submitted","under_review"].includes(O.status)&&(0,r.jsxs)("button",{className:"btn2",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to withdraw this application?"))try{d(!0),u(null);const a=await i.A.put(`${n.JR}/api/applications/${e}/withdraw`,{},{headers:(0,n.z5)()});if(!a.data.success)throw new Error(a.data.message||"Error withdrawing application");h("Application withdrawn successfully!"),f(!1),g(null),await R()}catch(p){var a,t;console.error("Error withdrawing application:",p),u((null===(a=p.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||"An error occurred while withdrawing the application")}finally{d(!1)}})(v.id),children:[(0,r.jsx)("i",{className:"fas fa-undo"})," Withdraw Application"]}))]}),"admin"===_&&"submitted"===v.status&&(0,r.jsxs)("div",{className:"admin-actions",children:[(0,r.jsx)("h3",{children:"Admin Actions"}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Notes:"}),(0,r.jsx)("textarea",{className:"form-textarea",rows:"4",placeholder:"Add notes for the applicant...",value:v.adminNotes||"",onChange:e=>g({...v,adminNotes:e.target.value})})]}),(0,r.jsxs)("div",{className:"button-group",children:[(0,r.jsx)("button",{className:"btn1",onClick:()=>L(v.id,"approved",v.adminNotes),children:"Approve"}),(0,r.jsx)("button",{className:"btn2",onClick:()=>L(v.id,"rejected",v.adminNotes),children:"Reject"}),(0,r.jsx)("button",{className:"btn2",onClick:()=>L(v.id,"under_review",v.adminNotes),children:"Put Under Review"})]})]})]}),(0,r.jsx)("button",{className:"close-button",onClick:()=>{f(!1),g(null)},children:(0,r.jsx)("i",{className:"fas fa-times"})})]})})]});var O}}}]);
//# sourceMappingURL=779.705235c2.chunk.js.map